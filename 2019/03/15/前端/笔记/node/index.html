<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>node | Yo.</title><meta name="description" content="node"><meta name="keywords" content="node"><meta name="author" content="Yo"><meta name="copyright" content="Yo"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="node"><meta name="twitter:description" content="node"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/powerlrl/imgBed/blog/imgu=2672937348,875131515&amp;fm=26&amp;gp=0.jpg"><meta property="og:type" content="article"><meta property="og:title" content="node"><meta property="og:url" content="http://yoursite.com/2019/03/15/前端/笔记/node/"><meta property="og:site_name" content="Yo."><meta property="og:description" content="node"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/powerlrl/imgBed/blog/imgu=2672937348,875131515&amp;fm=26&amp;gp=0.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://yoursite.com/2019/03/15/前端/笔记/node/"><link rel="prev" title="webpack" href="http://yoursite.com/2019/05/23/前端/工具/webpack/"><link rel="next" title="Ajax与Fetch" href="http://yoursite.com/2019/03/10/前端/笔记/Ajax与Fetch/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://powerlrl.github.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: true,
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"Press","message_next":"to bookmark this page"},"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Light Mode Activated Manually","night_to_day":"Dark Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Yo.</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-hearbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/powerlrl/imgBed/blog/imgu=2713983670,3137930009&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">21</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">17</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">5</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-hearbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#what‘s-node？"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">what‘s node？</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#node中是以模块来划分作用域"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">node中是以模块来划分作用域</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#现在我们不止想要读一个文件，我还想写入一个文件"><span class="toc_mobile_items-number">1.1.0.1.</span> <span class="toc_mobile_items-text">现在我们不止想要读一个文件，我还想写入一个文件</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#http模块"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">http模块</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#exports和module-exports的区别"><span class="toc_mobile_items-number">1.2.1.</span> <span class="toc_mobile_items-text">exports和module exports的区别</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Express"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">Express</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#一、安装express框架（npm-i-S-express）"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">一、安装express框架（npm i -S express）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#二、nodemon的使用"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">二、nodemon的使用</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#三、模板引擎的使用"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">三、模板引擎的使用</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#四、提取路由模块"><span class="toc_mobile_items-number">2.4.</span> <span class="toc_mobile_items-text">四、提取路由模块</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#五、静态资源库的开放"><span class="toc_mobile_items-number">2.5.</span> <span class="toc_mobile_items-text">五、静态资源库的开放</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#六、MongoDB"><span class="toc_mobile_items-number">2.6.</span> <span class="toc_mobile_items-text">六、MongoDB</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1、准备工作"><span class="toc_mobile_items-number">2.6.1.</span> <span class="toc_mobile_items-text">1、准备工作</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#（1）安装"><span class="toc_mobile_items-number">2.6.1.1.</span> <span class="toc_mobile_items-text">（1）安装</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#（2）配置环境变量"><span class="toc_mobile_items-number">2.6.1.2.</span> <span class="toc_mobile_items-text">（2）配置环境变量</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#（3）测试是否安装成功"><span class="toc_mobile_items-number">2.6.1.3.</span> <span class="toc_mobile_items-text">（3）测试是否安装成功</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#（4）开启数据库"><span class="toc_mobile_items-number">2.6.1.4.</span> <span class="toc_mobile_items-text">（4）开启数据库</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#（5）关闭数据库"><span class="toc_mobile_items-number">2.6.1.5.</span> <span class="toc_mobile_items-text">（5）关闭数据库</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-6"><a class="toc_mobile_items-link" href="#ctrl加c或者点击上面的叉即可"><span class="toc_mobile_items-number">2.6.1.5.1.</span> <span class="toc_mobile_items-text">ctrl加c或者点击上面的叉即可</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2、连接数据库"><span class="toc_mobile_items-number">2.6.2.</span> <span class="toc_mobile_items-text">2、连接数据库</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#（1）默认连接本地数据库"><span class="toc_mobile_items-number">2.6.2.1.</span> <span class="toc_mobile_items-text">（1）默认连接本地数据库</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#（2）在连接的时候退出数据库"><span class="toc_mobile_items-number">2.6.2.2.</span> <span class="toc_mobile_items-text">（2）在连接的时候退出数据库</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#（3）基本命令"><span class="toc_mobile_items-number">2.6.2.3.</span> <span class="toc_mobile_items-text">（3）基本命令</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3、MongoDB基本概念"><span class="toc_mobile_items-number">2.6.3.</span> <span class="toc_mobile_items-text">3、MongoDB基本概念</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#4、使用mongoose操作mongodb"><span class="toc_mobile_items-number">2.6.4.</span> <span class="toc_mobile_items-text">4、使用mongoose操作mongodb</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#5、增加数据"><span class="toc_mobile_items-number">2.6.5.</span> <span class="toc_mobile_items-text">5、增加数据</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#6、查询数据"><span class="toc_mobile_items-number">2.6.6.</span> <span class="toc_mobile_items-text">6、查询数据</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#7、删除数据"><span class="toc_mobile_items-number">2.6.7.</span> <span class="toc_mobile_items-text">7、删除数据</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#8、更新数据"><span class="toc_mobile_items-number">2.6.8.</span> <span class="toc_mobile_items-text">8、更新数据</span></a></li></ol></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#第二篇"><span class="toc_mobile_items-number"></span> <span class="toc_mobile_items-text">第二篇</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#对象"><span class="toc_mobile_items-number">0.1.</span> <span class="toc_mobile_items-text">对象</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#node所实现的规范"><span class="toc_mobile_items-number">0.2.</span> <span class="toc_mobile_items-text">node所实现的规范</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#文件的读取和写入"><span class="toc_mobile_items-number">0.3.</span> <span class="toc_mobile_items-text">文件的读取和写入</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#http"><span class="toc_mobile_items-number">0.4.</span> <span class="toc_mobile_items-text">http</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#状态码"><span class="toc_mobile_items-number">0.5.</span> <span class="toc_mobile_items-text">状态码</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#连接Mysql数据库"><span class="toc_mobile_items-number">0.6.</span> <span class="toc_mobile_items-text">连接Mysql数据库</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#KOA框架"><span class="toc_mobile_items-number">0.7.</span> <span class="toc_mobile_items-text">KOA框架</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#koa-bodyparser"><span class="toc_mobile_items-number">0.7.1.</span> <span class="toc_mobile_items-text">koa-bodyparser</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#koa-router"><span class="toc_mobile_items-number">0.7.2.</span> <span class="toc_mobile_items-text">koa-router**</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#koa-art-template"><span class="toc_mobile_items-number">0.7.3.</span> <span class="toc_mobile_items-text">koa-art-template**</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#koa-static"><span class="toc_mobile_items-number">0.7.4.</span> <span class="toc_mobile_items-text">koa-static</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#koa-session"><span class="toc_mobile_items-number">0.7.5.</span> <span class="toc_mobile_items-text">koa-session</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#koa中出错处理"><span class="toc_mobile_items-number">0.7.6.</span> <span class="toc_mobile_items-text">koa中出错处理</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#生成key"><span class="toc_mobile_items-number">0.8.</span> <span class="toc_mobile_items-text">生成key</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#what‘s-node？"><span class="toc-number">1.</span> <span class="toc-text">what‘s node？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#node中是以模块来划分作用域"><span class="toc-number">1.1.</span> <span class="toc-text">node中是以模块来划分作用域</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#现在我们不止想要读一个文件，我还想写入一个文件"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">现在我们不止想要读一个文件，我还想写入一个文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http模块"><span class="toc-number">1.2.</span> <span class="toc-text">http模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exports和module-exports的区别"><span class="toc-number">1.2.1.</span> <span class="toc-text">exports和module exports的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Express"><span class="toc-number">2.</span> <span class="toc-text">Express</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、安装express框架（npm-i-S-express）"><span class="toc-number">2.1.</span> <span class="toc-text">一、安装express框架（npm i -S express）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、nodemon的使用"><span class="toc-number">2.2.</span> <span class="toc-text">二、nodemon的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、模板引擎的使用"><span class="toc-number">2.3.</span> <span class="toc-text">三、模板引擎的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、提取路由模块"><span class="toc-number">2.4.</span> <span class="toc-text">四、提取路由模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、静态资源库的开放"><span class="toc-number">2.5.</span> <span class="toc-text">五、静态资源库的开放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#六、MongoDB"><span class="toc-number">2.6.</span> <span class="toc-text">六、MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、准备工作"><span class="toc-number">2.6.1.</span> <span class="toc-text">1、准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#（1）安装"><span class="toc-number">2.6.1.1.</span> <span class="toc-text">（1）安装</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（2）配置环境变量"><span class="toc-number">2.6.1.2.</span> <span class="toc-text">（2）配置环境变量</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（3）测试是否安装成功"><span class="toc-number">2.6.1.3.</span> <span class="toc-text">（3）测试是否安装成功</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（4）开启数据库"><span class="toc-number">2.6.1.4.</span> <span class="toc-text">（4）开启数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（5）关闭数据库"><span class="toc-number">2.6.1.5.</span> <span class="toc-text">（5）关闭数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#ctrl加c或者点击上面的叉即可"><span class="toc-number">2.6.1.5.1.</span> <span class="toc-text">ctrl加c或者点击上面的叉即可</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、连接数据库"><span class="toc-number">2.6.2.</span> <span class="toc-text">2、连接数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#（1）默认连接本地数据库"><span class="toc-number">2.6.2.1.</span> <span class="toc-text">（1）默认连接本地数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（2）在连接的时候退出数据库"><span class="toc-number">2.6.2.2.</span> <span class="toc-text">（2）在连接的时候退出数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（3）基本命令"><span class="toc-number">2.6.2.3.</span> <span class="toc-text">（3）基本命令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、MongoDB基本概念"><span class="toc-number">2.6.3.</span> <span class="toc-text">3、MongoDB基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、使用mongoose操作mongodb"><span class="toc-number">2.6.4.</span> <span class="toc-text">4、使用mongoose操作mongodb</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、增加数据"><span class="toc-number">2.6.5.</span> <span class="toc-text">5、增加数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、查询数据"><span class="toc-number">2.6.6.</span> <span class="toc-text">6、查询数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、删除数据"><span class="toc-number">2.6.7.</span> <span class="toc-text">7、删除数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、更新数据"><span class="toc-number">2.6.8.</span> <span class="toc-text">8、更新数据</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二篇"><span class="toc-number"></span> <span class="toc-text">第二篇</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#对象"><span class="toc-number">0.1.</span> <span class="toc-text">对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#node所实现的规范"><span class="toc-number">0.2.</span> <span class="toc-text">node所实现的规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件的读取和写入"><span class="toc-number">0.3.</span> <span class="toc-text">文件的读取和写入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http"><span class="toc-number">0.4.</span> <span class="toc-text">http</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#状态码"><span class="toc-number">0.5.</span> <span class="toc-text">状态码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#连接Mysql数据库"><span class="toc-number">0.6.</span> <span class="toc-text">连接Mysql数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KOA框架"><span class="toc-number">0.7.</span> <span class="toc-text">KOA框架</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#koa-bodyparser"><span class="toc-number">0.7.1.</span> <span class="toc-text">koa-bodyparser</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#koa-router"><span class="toc-number">0.7.2.</span> <span class="toc-text">koa-router**</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#koa-art-template"><span class="toc-number">0.7.3.</span> <span class="toc-text">koa-art-template**</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#koa-static"><span class="toc-number">0.7.4.</span> <span class="toc-text">koa-static</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#koa-session"><span class="toc-number">0.7.5.</span> <span class="toc-text">koa-session</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#koa中出错处理"><span class="toc-number">0.7.6.</span> <span class="toc-text">koa中出错处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生成key"><span class="toc-number">0.8.</span> <span class="toc-text">生成key</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/powerlrl/imgBed/blog/imgu=2672937348,875131515&amp;fm=26&amp;gp=0.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">node</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> Created 2019-03-15<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> Updated 2020-02-27</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/笔记/">笔记</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>Word count:</span><span class="word-count">4,243</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>Reading time: 17 min</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>Post View:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h2 id="what‘s-node？"><a href="#what‘s-node？" class="headerlink" title="what‘s node？"></a>what‘s node？</h2><blockquote>
<p>node既不是一种语言，也不是一个框架，更不是一个库。而是一种能让JavaScript运行在服务器上的一个平台</p>
</blockquote>
<blockquote>
<p>首先要下载node.js 自行到官网中下载。注意两个版本的区别</p>
</blockquote>
<h3 id="node中是以模块来划分作用域"><a href="#node中是以模块来划分作用域" class="headerlink" title="node中是以模块来划分作用域"></a>node中是以模块来划分作用域</h3><blockquote>
<p>node里面分为两个作用域，全局作用域（glogbal）和模块作用域</p>
</blockquote>
<ul>
<li><p>require（’模块标识符’） —–我们需引入模块需要用到的方法</p>
</li>
<li><p>模块</p>
<ul>
<li>用户自定义模块—-自己定义的一个js文件模块</li>
<li>系统提供模块—例如:fs,http…</li>
</ul>
</li>
</ul>
<a id="more"></a>
<blockquote>
<p>例如我们想要读取一个txt文件,JavaScript中是不可能实现的</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="comment">//如果读取成功，则返回一个回调函数，erro----null，data----一串16进制，否则的话，erro----报错，data---undefined</span></span><br><span class="line">fs.readFile(<span class="string">'txt路径'</span>,(erro,data)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(erro)</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">    <span class="comment">//如果想要获取文件中的内容，只需要把16进制转换为字符串即可</span></span><br><span class="line">    <span class="built_in">console</span>.log(data.toString())</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>
<ul>
<li>基本上路径如果，对的话是没有问题的，还有可能文件不存在。</li>
</ul>
<h5 id="现在我们不止想要读一个文件，我还想写入一个文件"><a href="#现在我们不止想要读一个文件，我还想写入一个文件" class="headerlink" title="现在我们不止想要读一个文件，我还想写入一个文件"></a>现在我们不止想要读一个文件，我还想写入一个文件</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.writeFile(<span class="string">'路径'</span>,<span class="string">'文件内容'</span>,error=&gt;&#123;</span><br><span class="line">    <span class="comment">//写入文件，如果成功则 error为null null又默认为0</span></span><br><span class="line">    <span class="keyword">if</span>(error)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'文件写入失败'</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'文件写入成功'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h3 id="http模块"><a href="#http模块" class="headerlink" title="http模块"></a>http模块</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//引入http模块</span></span><br><span class="line"><span class="keyword">let</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="comment">//创建服务器</span></span><br><span class="line"><span class="keyword">let</span> server = http.createServer(<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    url = req.url</span><br><span class="line">    <span class="comment">//查找url</span></span><br><span class="line">    <span class="keyword">if</span>(url === <span class="string">'/'</span>)&#123;</span><br><span class="line">        res.end(<span class="string">'http 的使用'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//开启服务器</span></span><br><span class="line">server.listen(<span class="number">3000</span>,()=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'running is server...'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h4 id="exports和module-exports的区别"><a href="#exports和module-exports的区别" class="headerlink" title="exports和module exports的区别"></a>exports和module exports的区别</h4><blockquote>
<p>很多时候我们需要引入到别的模块中的变量，这个时候我们就需要使用的exports或者module.exports来暴露我们需要使用的变量或者对象。每一个模块中都有一个module.exports对象，每一个module.exports对象都有一个exports对象，所以我们把需要暴露的对象都挂载在module.exports对象上。所以每次暴露都是module.exports.xxx = xxx但是为了方便同时又在每一个模块中提供了一个exports成员，还有exports === module.exports是为true假如我们只需要暴露xxx我们可以直接exports.xxx即可</p>
<p>如果我们暴露单个成员则需要使用module.exports不能使用exports因为最终返回的都是module.exports即使exports=xxx也不行，</p>
<p>但是有一种特别的特殊方法 exports=module.exports是可以的，</p>
<p>多次暴露使用exports</p>
<p>单次暴露使用module.exports</p>
<p>module.exports也可以多个暴露（module.exports={}即可）</p>
</blockquote>
<h2 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h2><h3 id="一、安装express框架（npm-i-S-express）"><a href="#一、安装express框架（npm-i-S-express）" class="headerlink" title="一、安装express框架（npm i -S express）"></a>一、安装express框架（npm i -S express）</h3><ul>
<li>引入express模块</li>
<li>定义变量接受express（）方法</li>
</ul>
<p>利用express实现helloworld</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">let</span> app = express()</span><br><span class="line"><span class="comment">//使用路由</span></span><br><span class="line">app.get(<span class="string">'/'</span>,(req,res)=&gt;&#123;</span><br><span class="line">  res.send(<span class="string">'hello world'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//使用路由</span></span><br><span class="line">app.get(<span class="string">'/login'</span>,(req,res)=&gt;&#123;</span><br><span class="line">  res.send(<span class="string">'login'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//开启服务器</span></span><br><span class="line">app.listen(<span class="number">3000</span>,()=&gt;&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'server is running'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<p>总的来说比我们之前写原生简单易懂的多。</p>
<h3 id="二、nodemon的使用"><a href="#二、nodemon的使用" class="headerlink" title="二、nodemon的使用"></a>二、nodemon的使用</h3><p>每一次修改完代码是不是每一次都要node app.js 还要每一次都要开启服务器。nodemon是我们每一次修改完代码后只要ctrl+s然后刷新浏览器就可以更改。</p>
<ul>
<li>npm i -g nodemon（安装nodemon）</li>
<li>nodenom -v （查看版本号）</li>
<li>nodemon xxx.js（运行js文件）</li>
</ul>
<h3 id="三、模板引擎的使用"><a href="#三、模板引擎的使用" class="headerlink" title="三、模板引擎的使用"></a>三、模板引擎的使用</h3><ul>
<li>先下载art-template</li>
<li>使用engine（’以什么文件后缀’，’express-art-template’）引入express-art-template包</li>
<li>使用路由get（）方式</li>
<li>使用render(‘渲染的文件’，{对象数据}) 默认到views文件夹中去寻找，若要修改则app.set(‘views’,’文件夹路径’)</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">let</span> app = express()</span><br><span class="line">app.engine(<span class="string">'html'</span>,<span class="built_in">require</span>(<span class="string">'art-template-express'</span>))</span><br><span class="line">app.get(<span class="string">'index.html'</span>,(req,res)=&gt;&#123;</span><br><span class="line">    res.render(<span class="string">'index.html'</span>)<span class="comment">//没有数据就无需写第二个参数</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置插件开始</span></span><br><span class="line"><span class="keyword">let</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>)</span><br><span class="line"><span class="comment">//配置body-parser</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"><span class="comment">// parse application/json</span></span><br><span class="line">app.use(bodyParser.json())</span><br><span class="line"><span class="comment">//插件配置结束</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用get方法获取数据，这个/pinglung是表单的action='/pinglun'，methond='get'</span></span><br><span class="line">app.get(<span class="string">'/pinglun'</span>,(req,res)=&gt;&#123;</span><br><span class="line"> <span class="keyword">let</span> comment = req.query</span><br><span class="line">  comment.dataTime = <span class="string">'2019-5-1'</span></span><br><span class="line">   comments.unshift(comment)</span><br><span class="line">  res.redirect(<span class="string">'/'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 使用post方法获取数据需要借助中间的插件body-parser才可以获取数据，不想get有一个内置的api (req.query),需要借助第三方插件，还需要配置</span></span><br><span class="line">app.post(<span class="string">'/post'</span>,(req,res)=&gt;&#123;</span><br><span class="line">  <span class="keyword">let</span> comment = req.body</span><br><span class="line">  comment.dataTime = <span class="string">'2018-3-5'</span></span><br><span class="line">  comments.unshift(comment)</span><br><span class="line">  res.redirect(<span class="string">'/'</span>)<span class="comment">//重定向</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h3 id="四、提取路由模块"><a href="#四、提取路由模块" class="headerlink" title="四、提取路由模块"></a>四、提取路由模块</h3><p>我们每一次写路由的时候都会用很多的页面，那么这个时候都写在app中似乎有些不妥，这个时候我们可以把路由模块单独提取出来，生成一个router.js 而app.js只作为入口文件，具体操作如下。</p>
<p><strong>app.js</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">let</span> app = express()</span><br><span class="line"><span class="comment">//加载用户自定义router.js模块</span></span><br><span class="line"><span class="keyword">let</span> router = <span class="built_in">require</span>(<span class="string">'./router'</span>)</span><br><span class="line"><span class="comment">//使用路由</span></span><br><span class="line">app.use(router)</span><br><span class="line">app.listen(<span class="number">3000</span>,()=&gt;&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'server is running'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<p><strong>router.js</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="comment">//路由都挂载在router上</span></span><br><span class="line"><span class="keyword">let</span> router = express.Router()</span><br><span class="line">router.get(<span class="string">'/'</span>,(req,res)=&gt;&#123;</span><br><span class="line">  res.send(<span class="string">'index'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/login'</span>,(req,res)=&gt;&#123;</span><br><span class="line">  res.send(<span class="string">'login'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/register'</span>,(req,res)=&gt;&#123;</span><br><span class="line">  res.send(<span class="string">'register'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//导出路由，以后任何的入口文件要使用路由，都可以使用</span></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure></div>
<p>把路由与入口文件这个样子就可以彻底分开，这样感觉显得更加整洁。</p>
<h3 id="五、静态资源库的开放"><a href="#五、静态资源库的开放" class="headerlink" title="五、静态资源库的开放"></a>五、静态资源库的开放</h3><p>在这里我们首先来看path模块中的join函数和<strong>dirname与</strong>basename</p>
<ul>
<li>__dirname——–针对与当前文件目录（没有当前文件的名字和扩展名）（动态的）</li>
<li><p>__basename——–当前文件的名字和扩展名（动态的的）</p>
</li>
<li><p>join（’c:\project\’，’\foo’）———–返回值c:\project\foo（将两个路径拼接在一起）</p>
</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">//要使用/public这个文件夹下的文件,开放当前路径下的/public文件夹中的所有文件</span></span><br><span class="line">app.use(<span class="string">'/public'</span>，express.static(path.join(__dirname,<span class="string">'/public'</span>)))</span><br></pre></td></tr></table></figure></div>
<h3 id="六、MongoDB"><a href="#六、MongoDB" class="headerlink" title="六、MongoDB"></a>六、MongoDB</h3><h4 id="1、准备工作"><a href="#1、准备工作" class="headerlink" title="1、准备工作"></a>1、准备工作</h4><h5 id="（1）安装"><a href="#（1）安装" class="headerlink" title="（1）安装"></a>（1）安装</h5><p>在官网中下载安装包</p>
<p>分为，完整安装和自定义安装（只要改个路径就行了）一般我们选择完整安装</p>
<p><a href="/2019/03/15/前端/笔记/node/Node/QQ图片20190402131646.png" data-fancybox="group" data-caption="" class="fancybox"><img alt="" title="" data-src="/2019/03/15/前端/笔记/node/Node/QQ图片20190402131646.png" class="lazyload"></a></p>
<h5 id="（2）配置环境变量"><a href="#（2）配置环境变量" class="headerlink" title="（2）配置环境变量"></a>（2）配置环境变量</h5><p>完整安装一般默认是放在C盘目录下</p>
<p><a href="/2019/03/15/前端/笔记/node/Node/QQ图片20190402131657.png" data-fancybox="group" data-caption="" class="fancybox"><img alt="" title="" data-src="/2019/03/15/前端/笔记/node/Node/QQ图片20190402131657.png" class="lazyload"></a></p>
<h5 id="（3）测试是否安装成功"><a href="#（3）测试是否安装成功" class="headerlink" title="（3）测试是否安装成功"></a>（3）测试是否安装成功</h5><p>一般如果我们在bin目录下直接点击mongod.exe会出现闪退，这也是我们为什么要配置环境变量的原因。</p>
<p><a href="/2019/03/15/前端/笔记/node/Node/QQ图片20190402131700.png" data-fancybox="group" data-caption="" class="fancybox"><img alt="" title="" data-src="/2019/03/15/前端/笔记/node/Node/QQ图片20190402131700.png" class="lazyload"></a></p>
<p>如果出现以上的信息那么就代表我们安装成功。</p>
<h5 id="（4）开启数据库"><a href="#（4）开启数据库" class="headerlink" title="（4）开启数据库"></a>（4）开启数据库</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># </span><br><span class="line">mongod 默认使用时会把mongod根目录盘中的/data/db作为数据存储目录</span><br><span class="line"><span class="comment">//开启数据库</span></span><br><span class="line">在命令行中输入</span><br><span class="line">mongod</span><br></pre></td></tr></table></figure></div>
<p><strong>attention： 在第一次开启数据库的时候我们必须要在盘符根目录下（我的是c盘）新建一个/data/db两个文件夹下</strong>，不然就会出现连接不成功（shutting down）</p>
<p>修改默认路径：mongod –dbpath=数据存储目录</p>
<p><a href="/2019/03/15/前端/笔记/node/Node/QQ图片20190402154330.png" data-fancybox="group" data-caption="" class="fancybox"><img alt="" title="" data-src="/2019/03/15/前端/笔记/node/Node/QQ图片20190402154330.png" class="lazyload"></a></p>
<p>如果新建了文件夹，则会success（看不懂吧。。是的）</p>
<p><a href="/2019/03/15/前端/笔记/node/Node/QQ图片20190402154815.png" data-fancybox="group" data-caption="" class="fancybox"><img alt="" title="" data-src="/2019/03/15/前端/笔记/node/Node/QQ图片20190402154815.png" class="lazyload"></a></p>
<h5 id="（5）关闭数据库"><a href="#（5）关闭数据库" class="headerlink" title="（5）关闭数据库"></a>（5）关闭数据库</h5><h6 id="ctrl加c或者点击上面的叉即可"><a href="#ctrl加c或者点击上面的叉即可" class="headerlink" title="ctrl加c或者点击上面的叉即可"></a><strong>ctrl加c或者点击上面的叉即可</strong></h6><h4 id="2、连接数据库"><a href="#2、连接数据库" class="headerlink" title="2、连接数据库"></a>2、连接数据库</h4><h5 id="（1）默认连接本地数据库"><a href="#（1）默认连接本地数据库" class="headerlink" title="（1）默认连接本地数据库"></a>（1）默认连接本地数据库</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mongo</span><br></pre></td></tr></table></figure></div>
<h5 id="（2）在连接的时候退出数据库"><a href="#（2）在连接的时候退出数据库" class="headerlink" title="（2）在连接的时候退出数据库"></a>（2）在连接的时候退出数据库</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure></div>
<h5 id="（3）基本命令"><a href="#（3）基本命令" class="headerlink" title="（3）基本命令"></a>（3）基本命令</h5><ul>
<li>show dbs<ul>
<li>显示所有数据库名称</li>
</ul>
</li>
<li><p>use “数据库名称”</p>
<ul>
<li>如果有该数据库则切换到，如没有则新建一个数据库</li>
</ul>
</li>
<li><p>db</p>
<ul>
<li>查看当前使用的数据库</li>
</ul>
</li>
<li>show collections<ul>
<li>查看当前数据库中的所有的集合</li>
</ul>
</li>
<li>show.[collections].find()<ul>
<li>查看数据库中集合的所有数据</li>
</ul>
</li>
</ul>
<p><strong>这里需要说明一下，如果直接db的话，会出现test，但是我们show dbs的时候却没有test这个数据库，这是怎么回事呢？这个原因是因为我的test的数据库中没有数据，如果插入数据的话，再show dbs的话，则会出现test数据库（任何一个空的数据库都是这样，除非里面有数据，否则的话不会出现）</strong></p>
<p>举个例子吧(假设下面的是终端)</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//创建或者切换数据库</span><br><span class="line">use itcast</span><br><span class="line">//向当前数据库中插入一个集合并且插入数据</span><br><span class="line">db.students.insertOne(&#123;&quot;name&quot;:&quot;jack&quot;&#125;)</span><br><span class="line">//查看数据库(插入成功的话就会有这个数据库，相反却没有)</span><br><span class="line">show dbs</span><br><span class="line">//查看当前数据库的集合(应该会是students)</span><br><span class="line">show collections</span><br><span class="line">//查看当前集合中的所有元素（&#123; &quot;_id&quot; : ObjectId(&quot;5ca346b9b0e4018e76041ca1&quot;), &quot;name&quot; : &quot;jack&quot; &#125;）</span><br><span class="line">db.students.find()</span><br></pre></td></tr></table></figure></div>
<h4 id="3、MongoDB基本概念"><a href="#3、MongoDB基本概念" class="headerlink" title="3、MongoDB基本概念"></a>3、MongoDB基本概念</h4><p>看到黑马视频一个描述MongoDB的挺有意思的:</p>
<ul>
<li>最外层的括号相当于MongoDB</li>
<li>qq，taobao，baidu。。相当于我们里面有很多数据库</li>
<li>user，product。。相当于数据库中的集合</li>
<li>name,age集合中的记录</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    qq:&#123;</span><br><span class="line">        user:[</span><br><span class="line">            &#123;<span class="string">"name"</span>:<span class="string">"张三"</span>,<span class="attr">age</span>:<span class="number">15</span>&#125;,</span><br><span class="line">            &#123;<span class="string">"name"</span>:<span class="string">"张三34"</span>,<span class="attr">age</span>:<span class="number">25</span>&#125;,</span><br><span class="line">    		&#123;<span class="string">"name"</span>:<span class="string">"李四"</span>,<span class="attr">age</span>:<span class="number">35</span>&#125;,</span><br><span class="line">    		&#123;<span class="string">"name"</span>:<span class="string">"张三34"</span>,<span class="attr">age</span>:<span class="number">45</span>&#125;，</span><br><span class="line">            ....</span><br><span class="line">        ],</span><br><span class="line">       product:[</span><br><span class="line">            ....</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">    taobao:&#123;</span><br><span class="line">            ...</span><br><span class="line">    &#125;,</span><br><span class="line">   baidu:&#123;</span><br><span class="line">              </span><br><span class="line">   &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="4、使用mongoose操作mongodb"><a href="#4、使用mongoose操作mongodb" class="headerlink" title="4、使用mongoose操作mongodb"></a>4、使用mongoose操作mongodb</h4><p>（1）安装mongoose包（npm i mongoose）</p>
<p>（2）引入mongoose模块 （let mongoose = require(mongoose)）</p>
<p>（3）创建架构</p>
<p>（4）连接数据库</p>
<p>（5）设计结合的结构</p>
<p>（6）将文档结构发布为模型</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="keyword">let</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>)</span><br><span class="line"><span class="comment">//3</span></span><br><span class="line"><span class="keyword">let</span> Schema = mongoose.Schema</span><br><span class="line"><span class="comment">//4</span></span><br><span class="line">mongoose.connect(<span class="string">'mongoose://localhost/数据库名称'</span>)</span><br><span class="line"><span class="comment">//5</span></span><br><span class="line"><span class="comment">//里面的字段就是集合结构中的属性名称</span></span><br><span class="line"><span class="comment">//约束的条件是为了防止有脏数据</span></span><br><span class="line"><span class="keyword">let</span> userSchema = <span class="keyword">new</span> Schema(&#123;</span><br><span class="line">  username: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    required: <span class="literal">true</span>,<span class="comment">//必须有该属性</span></span><br><span class="line">  &#125;,</span><br><span class="line">  password: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    required: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  email: &#123;</span><br><span class="line">    type: <span class="built_in">String</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//将文档结构发布为模型</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  第一个参数，大写的单数字符串作为你的数据库名称，mongoose会自动将你的数据库名称转换为小写复数集合名称</span></span><br><span class="line"><span class="comment">  列如这里的User最终会变成users集合名称</span></span><br><span class="line"><span class="comment">  第二个参数，架构Schema</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  返回值：模型构造函数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">let</span> User = mongoose.model(<span class="string">'User'</span>,userSchema)</span><br></pre></td></tr></table></figure></div>
<h4 id="5、增加数据"><a href="#5、增加数据" class="headerlink" title="5、增加数据"></a>5、增加数据</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> admin = <span class="keyword">new</span> User(&#123;</span><br><span class="line">  username: <span class="string">'zs'</span>,</span><br><span class="line">  password: <span class="string">'123456'</span>,</span><br><span class="line">  email: <span class="string">'3199895@qq.com'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">admin.save(<span class="function">(<span class="params">err,ret</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'保存失败'</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'保存成功'</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(ret)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h4 id="6、查询数据"><a href="#6、查询数据" class="headerlink" title="6、查询数据"></a>6、查询数据</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//查询所有的数据</span></span><br><span class="line">User.find(<span class="function">(<span class="params">err,ret</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'查询失败'</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ret)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//查询符合记录的数据</span></span><br><span class="line">User.findOne(&#123;</span><br><span class="line">  username: <span class="string">'zs'</span></span><br><span class="line">&#125;,(err,ret)=&gt;&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'查询失败'</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ret)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h4 id="7、删除数据"><a href="#7、删除数据" class="headerlink" title="7、删除数据"></a>7、删除数据</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//删除数据</span></span><br><span class="line">User.remove(&#123;</span><br><span class="line">  username: <span class="string">'zs'</span></span><br><span class="line">&#125;,(err,ret)=&gt;&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'删除失败'</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ret)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'删除成功'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h4 id="8、更新数据"><a href="#8、更新数据" class="headerlink" title="8、更新数据"></a>8、更新数据</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//更新数据 id，修改内容，名称</span></span><br><span class="line"></span><br><span class="line">User.findByIdAndUpdate(<span class="string">'5ca35aaa914afc2efceed812'</span>,&#123;</span><br><span class="line">  password: <span class="string">'123456'</span></span><br><span class="line">&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,ret</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'更新失败'</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ret)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'更新成功'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h1 id="第二篇"><a href="#第二篇" class="headerlink" title="第二篇"></a>第二篇</h1><h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><ul>
<li>全局对象：随时都能访问<ul>
<li>process.env</li>
<li>__filename（获取当前运行文件的绝对路径）</li>
<li>__dirname（获取当前运行文件目录的绝对路径）</li>
</ul>
</li>
<li>内置对象：向系统索要，引入即可</li>
<li>自定义对象：引入正确的路径即可</li>
</ul>
<h3 id="node所实现的规范"><a href="#node所实现的规范" class="headerlink" title="node所实现的规范"></a>node所实现的规范</h3><ul>
<li>CommonJS：规范nodeJS作为后端运行的标准    <ul>
<li>模块应该怎么写module<ul>
<li>依赖某一模块require</li>
<li>被依赖的模块需要module.exports = 外部数据</li>
</ul>
</li>
<li>一个文件就是一个模块</li>
</ul>
</li>
</ul>
<h3 id="文件的读取和写入"><a href="#文件的读取和写入" class="headerlink" title="文件的读取和写入"></a>文件的读取和写入</h3><blockquote>
<p>如果要对文件进行操作，就要先引入文件模块fs</p>
</blockquote>
<ul>
<li><em>readFile</em>(文件路径和名，’utf-8’，回调函数)异步读取文件的内容</li>
<li>readFileSync（）同步读取文件的内容</li>
<li>writeFile（文件的路径和名，文件内容，回调函数）</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line">fs.readFile(<span class="string">"./public/a.txt"</span>,<span class="string">"utf-8"</span>,(err,data)=&gt;&#123;</span><br><span class="line">  <span class="keyword">if</span>(err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;)</span><br><span class="line">fs.writeFile(<span class="string">"./public/b.txt"</span>,<span class="string">"哈哈哈，几天也是很难熬的一天啊"</span>,(err)=&gt;&#123;</span><br><span class="line">  <span class="keyword">if</span>(err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"写入文件完成"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h3 id="http"><a href="#http" class="headerlink" title="http"></a>http</h3><blockquote>
<p>http是node中的核心模块，同样的要先引入</p>
</blockquote>
<ul>
<li>createServer（）创建一个本地的服务器</li>
<li>http.on（）执行request请求，并有一回调函数，获取到request和，response参数。<ul>
<li>request是只读不能写入</li>
<li>response是可以写入</li>
</ul>
</li>
<li>http.listen（端口号，回调函数）用以开启服务器</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> port = process.env.PORT | <span class="number">3000</span></span><br><span class="line">http.createServer(<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="comment">// 多次写入 写头</span></span><br><span class="line">  res.setHeader(<span class="string">'a'</span>,<span class="string">'a'</span>)</span><br><span class="line">  res.setHeader(<span class="string">'c'</span>,<span class="string">'c'</span>)</span><br><span class="line">  <span class="comment">// 一次性写入，一定在多次写入的后面</span></span><br><span class="line">  res.writeHead(<span class="number">200</span>,&#123;<span class="string">'content-type'</span>:<span class="string">'text/html;charset=utf-8'</span>&#125;)</span><br><span class="line">  <span class="comment">//多次写体</span></span><br><span class="line">  res.write(<span class="string">'第一次写入'</span>)</span><br><span class="line">  res.end(<span class="string">'最后一次写入'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.listen(port,()=&gt;&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`server is running <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h3 id="状态码"><a href="#状态码" class="headerlink" title="状态码"></a>状态码</h3><ul>
<li>1开头正在执行</li>
<li>2开头已完成</li>
<li>3开头重定向</li>
<li>4开头客户端出现错误</li>
<li>5开头服务端出现错误</li>
</ul>
<h3 id="连接Mysql数据库"><a href="#连接Mysql数据库" class="headerlink" title="连接Mysql数据库"></a>连接Mysql数据库</h3><ul>
<li>npm i mysql -g（全局下载项目依赖模块）</li>
<li>复制对应代码</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var mysql = require(&apos;mysql&apos;);</span><br><span class="line">var pool = mysql.createConnection(&#123;</span><br><span class="line">  host: &apos;localhost&apos;,</span><br><span class="line">  user: &apos;root&apos;,</span><br><span class="line">  password: &apos;&apos;,</span><br><span class="line">  database: &apos;node_music&apos;</span><br><span class="line">&#125;);</span><br><span class="line">pool.connect()</span><br><span class="line">let db = &#123;&#125;</span><br><span class="line">db.q = function(sql,params)&#123;</span><br><span class="line">  pool.query(sql, params,function (error, results, fields) &#123;</span><br><span class="line">    if (error) throw error;</span><br><span class="line">    else&#123;</span><br><span class="line">      console.log(&apos;成功插入到数据库中&apos;)</span><br><span class="line">      console.log(results)</span><br><span class="line">      pool.end()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">module.exports = db</span><br></pre></td></tr></table></figure></div>
<h3 id="KOA框架"><a href="#KOA框架" class="headerlink" title="KOA框架"></a>KOA框架</h3><blockquote>
<p>主要介绍koa框架，express在上一篇文章已经介绍过了。koa框架是express的作者是同一个人，比起express（太大，太全）反而koa（轻量级，按需引入）</p>
</blockquote>
<ul>
<li>引入koa</li>
<li>创建一个koa对象</li>
<li>处理响应</li>
<li>开启服务器</li>
</ul>
<p><code>koa是非常智能的，如果我们读一个二进制的文件，它会帮我们下载下来。</code></p>
<p> <code>另外需要注意的是：koa采用的是es7中的async 和await需要和promise联合使用，废弃掉了express采用回调函数的机制</code></p>
<p><code>中间件的使用也是按需引入，比较方便</code></p>
<h4 id="koa-bodyparser"><a href="#koa-bodyparser" class="headerlink" title="koa-bodyparser"></a><strong>koa-bodyparser</strong></h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</span><br><span class="line">app.use(bodyParser())</span><br><span class="line">app.use( <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.body = ctx.request.body</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> port = process.env.PORT || <span class="number">3000</span></span><br><span class="line">app.listen(port,()=&gt;&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`server is running <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<ul>
<li>使用</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">'./db_test_01'</span>)</span><br><span class="line">db.q(<span class="string">`insert into users (title,single,time,file,uid) values(?,?,?,?,?)`</span>,[<span class="string">'小菜'</span>,<span class="string">'青花瓷'</span>,<span class="string">'03:00'</span>,<span class="string">'d:/'</span>,<span class="number">6</span>])</span><br></pre></td></tr></table></figure></div>
<h4 id="koa-router"><a href="#koa-router" class="headerlink" title="koa-router**"></a>koa-router**</h4><ul>
<li>npm i koa-router</li>
<li>引入路由模块</li>
<li>创建对象</li>
<li>和app相关联</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>)</span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router()</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">'/'</span>,<span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.body = <span class="string">'首页'</span></span><br><span class="line">&#125;)</span><br><span class="line">.post(<span class="string">'/post'</span>,<span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.body = ctx.request.body</span><br><span class="line">&#125;)</span><br><span class="line">app.use(router.routes())</span><br><span class="line">app.use(bodyParser())</span><br><span class="line"><span class="comment">//优化状态码的处理405和501不再是单一的404</span></span><br><span class="line">app.use(router.allowedMethods())</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = process.env.PORT || <span class="number">3000</span></span><br><span class="line">app.listen(port,()=&gt;&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`server is running <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<p> <strong>路由嵌套</strong></p>
<p>koa中把路由模块单独抽离出来，是希望可以开发大型的企业项目，可以有多级的路由嵌套。</p>
<p>以下是我们的目录树：</p>
<blockquote>
<p>├─03_koa_router<br>│  │  app.js<br>│<br>└─router<br>├─cat<br>├─new<br>└─user<br>       admin.js<br>       company.js<br>       index.js</p>
</blockquote>
<p>app.js中我们需要引入</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">router.use(<span class="string">'/user'</span>,<span class="built_in">require</span>(<span class="string">'./router/user'</span>))</span><br><span class="line">app.use(router.routes())</span><br></pre></td></tr></table></figure></div>
<p>index.js</p>
<p><code></code></p>
<h4 id="koa-art-template"><a href="#koa-art-template" class="headerlink" title="koa-art-template**"></a>koa-art-template**</h4><ul>
<li>模板引擎</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)</span><br><span class="line"><span class="keyword">const</span> render = <span class="built_in">require</span>(<span class="string">'koa-art-template'</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router()</span><br><span class="line"></span><br><span class="line">render(app,&#123;</span><br><span class="line">    <span class="comment">//到view中去找</span></span><br><span class="line">  root: path.join(__dirname,<span class="string">'view'</span>),</span><br><span class="line">    <span class="comment">//后缀文件名</span></span><br><span class="line">  extname: <span class="string">'.html'</span>,</span><br><span class="line">  debug: process.env.NODE_ENV !== <span class="string">'production'</span></span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/'</span>,<span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">    <span class="comment">//使用render函数</span></span><br><span class="line">  ctx.render(<span class="string">'index'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.use(router.routes())</span><br><span class="line">app.use(router.allowedMethods())</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = process.env.PORT || <span class="number">3000</span></span><br><span class="line">app.listen(port,()=&gt;&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`server is running <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h4 id="koa-static"><a href="#koa-static" class="headerlink" title="koa-static"></a><strong>koa-static</strong></h4><blockquote>
<p>这里面有点难以理解，我们只需要在上面的代码加上以下的两句代码即可，但是我们的index.html中的</p>
<p><script src="index.js"></script>//这里面不需要写目录文件夹名，一旦写就错了，如果写的话，我们需要判断</p>
</blockquote>
<ul>
<li>const static = require(‘koa-static’)</li>
<li>app.use(static(path.resolve(‘./js’)))</li>
</ul>
<p><code>前端静态写了目录文件夹名称的需要进行判断</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.use(<span class="keyword">async</span> (ctx,next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span>(ctx.url.startsWith(<span class="string">'/js'</span>))&#123;</span><br><span class="line">      <span class="comment">//一般的request请求不能修改，但是例外</span></span><br><span class="line">    ctx.url = ctx.url.replace(<span class="string">'/js'</span>,<span class="string">''</span>)</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">//无论满足不满足都应该放行</span></span><br><span class="line">  <span class="keyword">await</span> next()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h4 id="koa-session"><a href="#koa-session" class="headerlink" title="koa-session"></a>koa-session</h4><ul>
<li>必须引入koa-session</li>
<li>必须在路由挂载之前</li>
<li>一般都为默认值，不修改</li>
<li>signed如果设置false</li>
</ul>
<p><a href="/2019/03/15/前端/笔记/node/C:/Users\LRY-NB\AppData\Roaming\Typora\typora-user-images\1563256801627.png" data-fancybox="group" data-caption="1563256801627" class="fancybox"><img alt="1563256801627" title="1563256801627" data-src="/2019/03/15/前端/笔记/node/C:/Users\LRY-NB\AppData\Roaming\Typora\typora-user-images\1563256801627.png" class="lazyload"></a></p>
<p>则别人会获取到，然后进行解密。再篡改就麻烦了，所以我们一般设置为true，这样就会有个签名和初始值是对应的，修改的话后台会报异常</p>
<ul>
<li>httpOnly如果为true，我们客户端document.cookie就会获得到。反正不会</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>)</span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)</span><br><span class="line"><span class="keyword">const</span> render = <span class="built_in">require</span>(<span class="string">'koa-art-template'</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> = <span class="built_in">require</span>(<span class="string">'koa-static'</span>)</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">'koa-session'</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router()</span><br><span class="line"></span><br><span class="line">render(app,&#123;</span><br><span class="line">  root: path.join(__dirname,<span class="string">'view'</span>),</span><br><span class="line">  extname: <span class="string">'.html'</span>,</span><br><span class="line">  debug: process.env.NODE_ENV !== <span class="string">'production'</span></span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/'</span>,<span class="keyword">async</span> ctx =&gt;&#123;</span><br><span class="line">  ctx.render(<span class="string">'index'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.post(<span class="string">'/login'</span>,<span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> username = ctx.request.body.username;</span><br><span class="line">  <span class="keyword">let</span> password = ctx.request.body.password;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(username != <span class="string">"admin"</span> || password != <span class="string">"123"</span>)&#123;</span><br><span class="line">    ctx.throw(<span class="number">200</span>,<span class="string">'有急事去啦~'</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="comment">//在session中存放东西</span></span><br><span class="line">    ctx.session.user = &#123;</span><br><span class="line">      username: <span class="string">'admin'</span></span><br><span class="line">    &#125;</span><br><span class="line">    ctx.body = <span class="string">'登录成功'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">/加密算法字符串/</span><br><span class="line">app.keys = [<span class="string">'some secret hurr'</span>]</span><br><span class="line"><span class="keyword">const</span> CONFIG = &#123;</span><br><span class="line">  key: <span class="string">'koa:sess'</span>, <span class="comment">//cookie名称</span></span><br><span class="line">  maxAge: <span class="number">86400000</span>, </span><br><span class="line">  overwrite: <span class="literal">true</span>, </span><br><span class="line">  httpOnly: <span class="literal">true</span>, 不允许客户端修改cookie</span><br><span class="line">  signed: <span class="literal">true</span>, 数字签名，保证数据不被串改</span><br><span class="line">  rolling: <span class="literal">false</span>,过期时间顺延</span><br><span class="line">  renew: <span class="literal">false</span>, 是否开启一个新的</span><br><span class="line">&#125;</span><br><span class="line">app.use(<span class="keyword">static</span>(path.resolve(<span class="string">'./js'</span>)) )</span><br><span class="line">app.use(bodyParser())</span><br><span class="line">app.use(session(CONFIG, app));</span><br><span class="line">app.use(router.routes())</span><br><span class="line">app.use(router.allowedMethods())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = process.env.PORT || <span class="number">3000</span></span><br><span class="line">app.listen(port,()=&gt;&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`server is running <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<p>以上的方法并不能保证信息的安全性，并且cookie的值还会有长度限制，所以改用以下的方式，解不了密</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.keys = [<span class="string">'some secret hurr'</span>]</span><br><span class="line"><span class="keyword">let</span> store = &#123;</span><br><span class="line">  storage: &#123;&#125;,</span><br><span class="line">  get(key)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.storage[key]</span><br><span class="line">  &#125;,</span><br><span class="line">  set(key,sess)&#123;</span><br><span class="line">    <span class="keyword">this</span>.storage[key] = sess</span><br><span class="line">  &#125;,</span><br><span class="line">  destroy (key) &#123;</span><br><span class="line">    <span class="keyword">delete</span> <span class="keyword">this</span>.storage[key]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">app.use(session(&#123;store&#125;, app));</span><br></pre></td></tr></table></figure></div>
<h4 id="koa中出错处理"><a href="#koa中出错处理" class="headerlink" title="koa中出错处理"></a>koa中出错处理</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">ctx.throw()<span class="comment">//抛出异常</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">async</span> (ctx,next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">await</span> next()</span><br><span class="line">  &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">    ctx.status = <span class="number">200</span></span><br><span class="line">    ctx.body = <span class="string">`&lt;div&gt;你访问的页面失联了&lt;/div&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h3 id="生成key"><a href="#生成key" class="headerlink" title="生成key"></a>生成key</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> key_len = <span class="number">1024</span></span><br><span class="line"><span class="keyword">const</span> key_count = <span class="number">2048</span></span><br><span class="line"><span class="keyword">let</span> char = <span class="string">'idOFIGLSFGJKSFGfHSGFHusakjfds#￥#@6556aHGSFff&#123;&#125;D&#125;&#123;：SFJAfdsafJ*（……%5KFSdgfdasfkdsjDJF355435&amp;*'</span></span><br><span class="line"><span class="keyword">let</span> arr = []</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; key_count; i++)&#123;</span><br><span class="line">  <span class="keyword">let</span> key = <span class="string">''</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; key_len; j++)&#123;</span><br><span class="line">    key += char[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*char.length)]</span><br><span class="line">  &#125;</span><br><span class="line">  arr.push(key)</span><br><span class="line">&#125;</span><br><span class="line">fs.writeFileSync(<span class="string">'.keys'</span>,arr.join(<span class="string">'/n'</span>))</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`get <span class="subst">$&#123;key_count&#125;</span>`</span>)</span><br></pre></td></tr></table></figure></div>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Yo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/03/15/前端/笔记/node/">http://yoursite.com/2019/03/15/前端/笔记/node/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/node/">node    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/powerlrl/imgBed/blog/imgu=2672937348,875131515&amp;fm=26&amp;gp=0.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/" alt="谢谢你请我吃糖果"><div class="post-qr-code__desc">谢谢你请我吃糖果</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/05/23/前端/工具/webpack/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Previous Post</div><div class="prev_info"><span>webpack</span></div></a></div><div class="next-post pull_right"><a href="/2019/03/10/前端/笔记/Ajax与Fetch/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/powerlrl/imgBed/blog/img下载 (1).jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Next Post</div><div class="next_info"><span>Ajax与Fetch</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> Comment</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'',
  appKey:'',
  placeholder:'Please leave your footprints',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'5',
  lang:'en',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/powerlrl/imgBed/blog/imgu=2672937348,875131515&amp;fm=26&amp;gp=0.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By Yo</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi,welcome to my<a href="https://powerlrl.github.io">blog</a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="Scroll to comment"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>